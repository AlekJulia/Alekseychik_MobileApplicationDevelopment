// Константы для напряжения на выводах ПЛИС
`define VOLTAGE_1_2 "-name IO_STANDARD \"1.2-V\""
`define VOLTAGE_2_5 "-name IO_STANDARD \"2.5-V\""

// Привязка сигналов к физическим выводам ПЛИС
`define PIN_CLOCK     "H12"   // Вывод тактового сигнала (50 МГц)
`define PIN_RESET_BTN "P11"   // Вывод кнопки сброса (активный низкий уровень)
`define PIN_UART_RX   "M9"    // Вывод приёма данных UART
`define PIN_UART_TX   "L9"    // Вывод передачи данных UART

// ============================================================================
// ВЕРХНИЙ МОДУЛЬ ДЛЯ UART ЭХО-КОНТРОЛЛЕРА
// ============================================================================
module uart_echo_top(
    // Тактовый сигнал 50 МГц (высокое напряжение = 1)
    (* chip_pin = `PIN_CLOCK *) 
    input wire system_clock,
    
    // Кнопка сброса: нажата = 0 (низкий уровень), отпущена = 1 (высокий уровень)
    (* altera_attribute = `VOLTAGE_1_2, chip_pin = `PIN_RESET_BTN *) 
    input wire reset_button_n,
    
    // Вход приёма UART: данные от компьютера → в ПЛИС
    (* altera_attribute = `VOLTAGE_2_5, chip_pin = `PIN_UART_RX *) 
    input wire uart_receive_in,
    
    // Выход передачи UART: данные из ПЛИС → в компьютер
    (* altera_attribute = `VOLTAGE_2_5, chip_pin = `PIN_UART_TX *) 
    output wire uart_transmit_out
);

    // ========================================================================
    // ПОДКЛЮЧЕНИЕ UART ЭХО-КОНТРОЛЛЕРА
    // ========================================================================
    // Этот модуль принимает данные по UART и сразу отправляет их обратно
    
    uart_echo #(
        .CLK_FREQ(50_000_000),    // Частота тактового сигнала: 50 МГц
        .BAUD_RATE(115200)        // Скорость UART: 115200 бит/сек
    ) uart_echo_controller (
        // Системные сигналы
        .clk(system_clock),       // Тактовый сигнал 50 МГц
        .reset_n(reset_button_n), // Кнопка сброса (активный низкий уровень)
        
        // UART интерфейс
        .uart_rx(uart_receive_in),    // Принимаем данные с компьютера
        .uart_tx(uart_transmit_out)   // Отправляем данные обратно
    );

endmodule